---
import ThemeButton from "./buttons/Theme.vue";
import MenuButton from "./buttons/Menu.vue";

const title = import.meta.env.APP_NAME;
---

<header>
	<ul class="container">
		<a href="/" class="app-title">
			{
				[...title].map((char) => {
					return char !== " " ? <span class="char">{char}</span> : <span class="char">&nbsp;</span>;
				})
			}
		</a>
		<ul class="btns">
			<ThemeButton client:load />
			<MenuButton client:load />
		</ul>
	</ul>
</header>

<script>
	import { gsap } from "gsap";

	const title = document.querySelectorAll(".char");
	const menuContent = document.querySelector(".menu-content");
	const menuBtn = document.getElementById("menu-btn");
	const menuLinks = document.querySelectorAll(".menu-link");

	gsap.set(menuContent, {
		autoAlpha: 0,
	});

	gsap.set(menuLinks, {
		x: -100,
	});

	const openMenu = gsap
		.timeline({ paused: true })
		.to(menuContent, {
			autoAlpha: 1,
		})
		.to(
			menuLinks,
			{
				autoAlpha: 1,
				x: 0,
				ease: "power4.out",
				duration: 0.3,
				stagger: {
					each: 0.05,
				},
			},
			"-=0.5"
		);

	const closeMenu = gsap
		.timeline({ paused: true })
		.to(menuLinks, {
			autoAlpha: 0,
			x: -100,
			ease: "power4.out",
			duration: 0.3,
			stagger: {
				each: 0.05,
				from: "end",
			},
		})
		.to(
			menuContent,
			{
				autoAlpha: 0,
			},
			"-=0.3"
		);

	let isOpen: boolean = false;
	menuBtn!.addEventListener("click", async () => {
		if (isOpen) {
			menuContent!.classList.remove("is-open");
			await closeMenu.restart();
		} else {
			menuContent!.classList.add("is-open");
			await openMenu.restart();
		}
		isOpen = !isOpen;
	});

	gsap.set(title, {
		y: 100,
	});

	gsap.to(title, {
		y: 0,
		ease: "power4.out",
		stagger: {
			each: 0.05,
		},
	});
</script>

<style lang="scss">
	header {
		position: relative;
		width: 100vw;
		height: 36px;
		padding: 0 12px;
		background: getColor(--bg-primary-color, 0.9);
		position: fixed;
		top: 0;
		z-index: 9999;

		@include resp(sm) {
			height: 48px;
			padding: 0 24px;
		}

		@include resp(lg) {
			height: 64px;
			padding: 0 48px;
		}

		.container {
			width: 100%;
			height: 100%;
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.app-title {
			font-size: 1rem;
			font-weight: 700;
			letter-spacing: 0.5px;
			overflow-y: hidden;

			@include resp(lg) {
				font-size: 1.8rem;
				letter-spacing: 1px;
			}

			.char {
				display: inline-block;
				color: getColor(--text-primary-color);
			}
		}

		.btns {
			display: flex;
			align-items: center;
			gap: 1rem;

			@include resp(lg) {
				gap: 3rem;
			}
		}
	}
</style>
