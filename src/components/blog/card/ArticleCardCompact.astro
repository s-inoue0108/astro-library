---
// Image
import { Image } from "astro:assets";
import type { Article } from "../../../lib/newt/types";

interface Props {
	article: Pick<Article, "title" | "slug" | "thambnail" | "category">;
}

const { article } = Astro.props;
const { title, slug, thambnail, category } = article;

const sliceText = (text: string | undefined, limit: number): string => {
	if (!text || text.length === 0) {
		return "";
	}
	if (text && text.length > limit) {
		return `${text.slice(0, limit)}...`;
	}
	return text;
};

const svgColor = category.themeColor;
---

<a href={`/blog/article/${slug}`} class="card">
	<ul class="info">
		<li class="thambnail">
			<Image
				width={thambnail.width}
				height={thambnail.height}
				src={thambnail.src}
				alt={thambnail.altText}
			/>
			<div class="svg-bg">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox={category.svgViewBox}>
					<path d={category.svgIconPath}></path>
				</svg>
			</div>
		</li>
		<li class="title">{sliceText(title, 50)}</li>
	</ul>
</a>

<style lang="scss" define:vars={{ svgColor }}>
	.card {
		background: getColor(--bg-secondary-color);
		width: 100%;
		height: 80px;
		display: block;
		border-radius: 4px;
		border: solid 1px getColor(--border-color);

		@include resp(lg) {
			height: 128px;
		}

		&:active {
			opacity: 0.5;
			transition: 0.2s ease;
		}

		.info {
			display: flex;
			width: 100%;
			height: 100%;

			.thambnail {
				width: 30%;
				height: 100%;
				position: relative;

				img {
					width: 100%;
					height: 100%;
					object-fit: cover;
					border-radius: 2px 0 0 2px;

					@include resp(lg) {
						border-radius: 4px 0 0 4px;
					}
				}

				.svg-bg {
					width: 100%;
					height: 1.2rem;
					position: absolute;
					top: 0;
					background: getColor(--bg-secondary-color, 0.5);
					border-top-left-radius: 2px;

					@include resp(lg) {
						height: 1.8rem;
						border-top-left-radius: 4px;
					}

					svg {
						margin-left: 2px;
						width: auto;
						height: 1.2rem;
						fill: var(--svgColor);

						@include resp(lg) {
							margin-left: 4px;
							height: 1.8rem;
						}
					}
				}
			}

			.title {
				width: 70%;
				padding: 0.5rem;

				@include resp(lg) {
					font-size: 1.2rem;
				}
			}
		}
	}
</style>
